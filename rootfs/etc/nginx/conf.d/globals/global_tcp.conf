# Базовые оптимизации ввода-вывода и TCP

# Включает системный вызов sendfile(): ядро берёт данные прямо из файлового кеша
# и отправляет в сокет, минуя user-space. Уменьшает количество копирований данных
# и контекстных переключений, особенно эффективно при отдаче статики (CSS/JS/картинки).
sendfile        on;

# Для TCP-подключений с sendfile оптимизирует отправку HTTP-заголовков и начала ответа:
# Nginx старается собрать заголовки и часть тела в один крупный пакет.
# Это уменьшает количество маленьких пакетов и улучшает пропускную способность.
tcp_nopush      on;

# Отключает алгоритм Nagle для keepalive-соединений: мелкие ответы (например, маленький JSON)
# отправляются сразу, без ожидания накопления данных. Снижает задержки при обработке
# последовательности небольших запросов на одном соединении.
tcp_nodelay     on;

# Максимальное время, в течение которого могут обрабатываться запросы в рамках keep-alive соединения.
# По достижении заданного времени соединение закрывается после обработки очередного запроса.
keepalive_time 1h;

# Увеличенный размер хеша типов MIME (таблицы расширение -> Content-Type).
# Нужен, если используется расширенный список типов или много кастомных типов,
# чтобы избежать коллизий и снизить накладные расходы на поиск MIME-типа.
types_hash_max_size 4096;
